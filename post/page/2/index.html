
<!doctype html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
  <title>Posts</title>
  <script src="https://kris0923.github.io/bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="https://kris0923.github.io/bower_components/iron-icons/iron-icons.html">
  <link rel="import" href="https://kris0923.github.io/bower_components/paper-drawer-panel/paper-drawer-panel.html">
  <link rel="import" href="https://kris0923.github.io/bower_components/paper-icon-button/paper-icon-button.html">
  <link rel="import" href="https://kris0923.github.io/bower_components/paper-toolbar/paper-toolbar.html">
  <link rel="import" href="https://kris0923.github.io/bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html">
  <link rel="import" href="https://kris0923.github.io/bower_components/paper-fab/paper-fab.html">
  <link rel="import" href="https://kris0923.github.io/bower_components/paper-item/paper-item.html">
  <link rel="import" href="https://kris0923.github.io/bower_components/paper-menu/paper-menu.html">
  <link rel="import" href="https://kris0923.github.io/bower_components/iron-image/iron-image.html">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/default.min.css">
  <style is="custom-style">
    body {
      font-family: 'Roboto', sans-serif;
    }
    .nav {
      border-right: 1px solid #ccc;
    }
    
    paper-scroll-header-panel {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      background-color: var(--paper-grey-200, #eee);
       
      --paper-scroll-header-panel-full-header: {
        background-image: url(https://kris0923.github.io/images/cover.png);
      };
       
      --paper-scroll-header-panel-condensed-header: {
        background-image: url(https://kris0923.github.io/images/cover.png);
      };
    }
    
    paper-toolbar {
       
      height: 256px;
      background-color: transparent;
    }
    .profile{
      width: 100%;
      padding-bottom: 20px;
    }
    .photo{
      margin: 20px;
      display: inline-block;
      height: 64px; width: 64px;
      border-radius: 50%;
    }
    .article{
      border: 1px solid #bebebe;
      padding: 16px;
      margin: 16px;
      border-radius: 5px;
      background-color: #fff;
    }
    .title{
      font-size: 22px;
      padding: 8px 0 16px;
    }
    .description{
      font-size: 16px;
      padding-bottom: 8px;
    }
    .author{
      font-size: 16px;
      padding-left: 20px;
      color: white;
    }
    .design{
      font-size: 14px;
    }
    .copyright{
      font-size: 16px;
    }
    paper-menu a {
      text-decoration: none;
      color: #212121;
    }
  </style>

</head>
<body>
  <paper-drawer-panel id="drawerPanel" responsive-width="1280px">
    <div class="nav scroll" drawer>
    
      <iron-image class="profile" sizing="cover" src="https://kris0923.github.io/images/profile.png">
    
        
          <iron-image class="photo" sizing="cover" src="https://kris0923.github.io/images/logo.jpeg"></iron-image>
        
          <div class="author">magicio</div>
      </iron-image>
      <paper-menu>
        <a href="https://kris0923.github.io"><paper-item>
          <iron-icon icon="home"></iron-icon>　<div class="flex">Home</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
        <a href="https://kris0923.github.io/categories/"><paper-item>
          <iron-icon icon="drafts"></iron-icon>　<div class="flex">Categories</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
        <a href="https://kris0923.github.io/tags/"><paper-item>
          <iron-icon icon="loyalty"></iron-icon>　<div class="flex">Tags</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
      </paper-menu>
    </div>

    <paper-scroll-header-panel main condenses header-height="256" condensed-header-height="64">

      <paper-toolbar>

        <paper-icon-button icon="menu" paper-drawer-toggle></paper-icon-button>
        <div class="bottom title">地球是个球体，哪里来的什么东南西北。只是因为我们从自己立场去看，才有了方向，有了是非</div>
        <div class="flex"></div>
        
        
        
        
        
          <a href="https://github.com/kris0923"><paper-icon-button src="https://kris0923.github.io/images/github2-dreamstale35.png"></paper-icon-button></a>
        
          <a href="https://kris0923.github.io/index.xml"><paper-icon-button src="https://kris0923.github.io/images/feed-dreamstale27.png"></paper-icon-button></a>
      
      </paper-toolbar>



<div class="content">


  <div class="article">
    <div class="title"><a href="https://kris0923.github.io/post/php5%E4%B8%8Ephp7%E7%9A%84zval%E6%AF%94%E8%BE%83/">PHP5与PHP7的zval比较</a></div>
    
      <div class="categories">
        
          <a href="https://kris0923.github.io/categories/php/">php</a>
        
      </div>
     
    <div class="description">PHP5中zval定义 struct _zval struct { zvalue_value value; // 16 zend_unit refcount_gc; // 4字节 引用计数 zend_uchar type; // 1 zend_uchar is_ref__gc; // 1 是否为引用类型 } typedef union _avalue_value { long lval; // 8 double dval; // 8 struct { char *val; int len; } str; // 16 HashTable *ht; // HashTable 数组 8 zend_object_value obj; // 12 zend_ast * ast; // 8 } zvalue_value;  为了解决*循环引用问题*，PHP5.3之后通过重写分配zval的宏，对zval进行扩充，新的分配方式：
#undef ALLOC_ZVAL #define ALLOC_ZVAL (z) do { (z) = (zval*) emalloc (sizeof(zval_gc_info)); GC_ZVAL_INT (z); } while(0) // _zval_gc_info 结构如下： typedef struct _zval_gc_info { zval z; union { gc_root_buffer *buffer; struct _zval_gc_info *next; } }  除此之外，在开启Zend内存池的情况下，zval_gc_info 在内存池中分配，内存池会为每个zval_gc_info额外申请一个大小为16字节的zend_mm_block结构体，用来存放内存相关信息，zend_mm_block结构如下：</div>
    <div class="tags">
      17 Jul 2019
      
        
          <a href="https://kris0923.github.io/tags/php/">#php</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://kris0923.github.io/post/%E4%BB%8Ehello-world%E5%BC%80%E5%A7%8B/">Mysql事务和锁</a></div>
    
      <div class="categories">
        
          <a href="https://kris0923.github.io/categories/mysql/">MySql</a>
        
      </div>
     
    <div class="description"> 什么是事务 </div>
    <div class="tags">
      15 Jun 2018
      
        
          <a href="https://kris0923.github.io/tags/mysql/">#MySql</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://kris0923.github.io/post/go-%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">GO语言语法基础</a></div>
    
      <div class="categories">
        
          <a href="https://kris0923.github.io/categories/go/">go</a>
        
      </div>
     
    <div class="description">基础语法  i++, i&ndash; 在go语言中是语句，而不像其他语言一样是表达式，所以， j = i++ 在go语言里面是不合法的,并且只支持后缀， &ndash;i 是不合法的 for 是go里面唯一的循环语句
传统的while循环写成
for condition {
}
 函数
函数的类型，称为函数签名，函数的实参都是按值传递的
 文件结束标示
err = errors.New(&quot;EOF&quot;) in := bufio.NewReader(os.stdin) for { r,_,err = in.ReadRune() if err == io.EOF { break // 文本结束标记 } if err != nil { return fmt.Errorf(&quot;read failed: $v&quot;,err) } // 处理逻辑 }  go 文本结束标记不怎么友好，为什么要放到error信息中
 数组 Go 语言中的数组是一种 值类型（不像 C/C++ 中是指向首元素的指针），所以可以通过 new() 来创建： var arr1 = new([5]int)。</div>
    <div class="tags">
      1 Jan 0001
      
        
          <a href="https://kris0923.github.io/tags/go/">#go</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://kris0923.github.io/post/php-%E5%86%85%E6%A0%B8%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0%E4%B8%80/">PHP 内核分析笔记（一）单进程SAPI生命周期</a></div>
    
      <div class="categories">
        
          <a href="https://kris0923.github.io/categories/php/">php</a>
        
      </div>
     
    <div class="description">http://www.php-internals.com/images/book/chapt02/02-00-php-
单进程SAPI生命周期 :start php -f test.php call each extension`s MINIT (模块初始化阶段，调用所有模块的MINIT函数) Request test.php call each extension`s RINIT (调用所有模块的RINIT函数) Execute test.php call each extension`s RSHUTDOWM Finsh cleaning up after test.php call each extension`s MSHUTDOWM （Web服务器退出或者命令行脚本执行完毕退出） terminate test.php :end  启动 模块初始化阶段  初始化若干全局变量 初始化若干常量，这里的常量是PHP自己的一些常量，如PHP_VERSION 初始化Zend引擎和核心组件 解析php.ini 全局操作函数的初始化 初始化静态构建的模块和共享模块(MINIT) 禁用函数和类 php_disable_functions, 其禁用的过程是调用zend_disable_function函数将指定的函数名从CG(function_table)函数表中删除,php_disable_classes,将指定的类名从CG(class_table)类表中删除  ACTIVATION  激活Zend引擎 激活SAPI 环境初始化 这里的环境初始化是指在用户空间中需要用到的一些环境变量初始化，这里的环境包括服务器环境、请求数据环境等。 实际到我们用到的变量，就是$_POST、$_GET、$_COOKIE、$_SERVER、$_ENV、$_FILES。 和sapi_module.default_post_reader一样，sapi_module.treat_data的值也是在模块初始化时， 通过php_startup_sapi_content_types函数注册了默认数据处理函数为main/php_variables.c文件中php_default_treat_data函数 模块请求初始化 (Call each extension&rsquo;s RINIT)
运行 php_execute_script 函数包含了运行PHP脚本的全部过程
DEACTIVATION PHP关闭请求的过程是一个若干个关闭操作的集合，这个集合存在于php_request_shutdown函数中</div>
    <div class="tags">
      1 Jan 0001
      
        
          <a href="https://kris0923.github.io/tags/php/">#php</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://kris0923.github.io/post/php-%E5%86%85%E6%A0%B8%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0%E4%BA%8C/">PHP 内核分析笔记（二）多进程与多线程SAPI生命周期</a></div>
    
      <div class="categories">
        
          <a href="https://kris0923.github.io/categories/php/">php</a>
        
      </div>
     
    <div class="description"> 多进程SAPI生命周期 以Apache为例，PHP编译为apache的一个模块来处理php请求，Apache启动后会fork多个进程，每个进程拥有独立的内存空间，单独处理php请求，所以每个子进程都是完整的生命周期 多线程的SAPI生命周期 同一组线程只有一个模块初始化和销毁的过程 </div>
    <div class="tags">
      1 Jan 0001
      
        
          <a href="https://kris0923.github.io/tags/php/">#php</a>
        
       
    </div>
  </div>

  <div class="article">
    <div class="title"><a href="https://kris0923.github.io/post/php-summarize/">PHP 知识总结（一）</a></div>
    
      <div class="categories">
        
          <a href="https://kris0923.github.io/categories/php/">php</a>
        
      </div>
     
    <div class="description">语法基础 变量类型  boolean integet float
# 判断是否是一个数值类型 bool is_nan(float $val)  string
// 字符串转数值 //如果 字符串中包含 '.', 'e'或者'E' 转换为float，其余转为 int  Array
// 数组的key只能是int 或string 合法的整型字符串会被转成int，例如：&quot;8&quot;，&quot;08&quot;不会，因为08不是合法的十进制数 浮点数也会被转换为整型，意味着其小数部分会被舍去。例如键名 8.7 实际会被储存为 8。 布尔值也会被转换成整型。即键名 true 实际会被储存为 1 而键名 false 会被储存为 0。 Null 会被转换为空字符串，即键名 null 实际会被储存为 &quot;&quot;。 数组和对象不能被用为键名。坚持这么做会导致警告：Illegal offset type 默认键： 当前最大整数索引值加1 // 其他类型转为数组 $a = array($a); or $a = (array) $a; 如果一个 object 类型转换为 array，则结果为一个数组，其单元为该对象的属性。键名将为成员变量名，不过有几点例外：整数属性不可访问；私有变量前会加上类名作前缀；保护变量前会加上一个 '*' 做前缀。这些前缀的前后都各有一个 NULL 字符。这会导致一些不可预知的行为： class A { private $A; // This will become '\0A\0A' } class B extends A { private $A; // This will become '\0B\0A' public $AA; // This will become 'AA' } var_dump((array) new B()); //上例会有两个键名为 'AA'，不过其中一个实际上是 '\0A\0A'  Object</div>
    <div class="tags">
      1 Jan 0001
      
        
          <a href="https://kris0923.github.io/tags/php/">#php</a>
        
       
    </div>
  </div>


</div>


<paper-item>
  
    <a href="/post/"><paper-fab icon="chevron-left"><a></a></paper-fab></a>
  
    <div class="flex"></div>
  
    <paper-fab disabled icon="chevron-right"></paper-fab>
  
</paper-item>


      <paper-item>
        <div class="copyright"></div>
        <div class="flex"></div>
        <div class="design">Design <a href="http://pdevty.github.io/blog/">pdevty</a></div>
      </paper-item>
    </paper-scroll-header-panel>
  </paper-drawer-panel>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
</body>
</html>
