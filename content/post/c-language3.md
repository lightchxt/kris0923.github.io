---
title: "《C程序设计语言学习笔记》（三）"
date: 2023-07-28T09:37:14+08:00
draft: false
categories: []
tags: []
---

第五章主要讲了指针与地址、指针与函数参数、指针与数组、地址算术运算、字符指针与函数、指针数组及指向指针的指针、多维数组、指针数组的初始化、指针与多维数组、命令行参数、指向函数的指针、复杂申明等内容。

指针与地址
- 指针可以保存变量的地址，通过指针可以访问或修改变量。

指针与函数参数
- C语言是通过传值方式将参数传递给函数的，如果需要修改调用者变量的值，就需要传递指针。

指针与数组
- 指针和数组有密切的关系，可以使用指针来对数组进行遍历和操作，这通常比使用数组下标更快。
- 数组名是一个指向数组第一个元素的指针常量，可以通过指针算术来访问数组中的元素。

地址算术运算符
- 使用地址算术运算符可以对指针进行加减操作。

字符指针与函数
- 字符指针常用于处理字符串，通过指针操作可以方便地对字符串进行复制、拼接等操作。

指针数组及指向指针的指针
- 指针数组是一个数组，其中的每个元素都是一个指针。
- 指向指针的指针是指一个指针变量存储的是另一个指针的地址。

多维数组
- 多维数组是指数组中的每个元素也是一个数组，形成了一个多维的数据结构。

指针数组的初始化
- 指针数组的初始化可以通过直接给每个元素赋值或者使用字符串常量进行初始化。

指针与多维数组
- 指针和多维数组的关系比较复杂，指针可以用来访问多维数组的元素。

命令行参数
- 程序启动时可以通过命令行输入参数，argc表示参数数量，argv保存参数列表。

指向函数的指针
- 指向函数的指针可以增强函数的灵活性，可以以函数作为参数传递给其他函数。

复杂申明
- 复杂申明指的是一些较难理解的声明，如 int *f() 和 int (\*p*f)()，需要注意声明符与可读性的兼顾。

第六章主要介绍了结构的相关知识，包括结构的基本概念、用法和常见操作。以下是主要内容的总结：

结构的基本知识
- 结构是一种用户定义的数据类型，用来表示不同的数据类型组成的数据。
- 结构中可以包含多种不同的数据类型，每个数据元素都有自己的名称。
- 结构可以通过复制整体、取地址符号、访问成员等方式进行操作。

结构与函数
- 结构可以作为参数传递给函数，这种传递可以是复制整体、传递结构指针等方式。
- 结构还可以作为函数的返回值，这种返回值可以是整体返回、通过指针返回等方式。

结构数组
- 结构数组是由多个结构组成的数组，每个结构可以包含不同的数据类型。
- 可以使用数组下标和指针来访问结构数组中的元素。

指向结构的指针
- 指向结构的指针保存的是结构变量的地址。
- 可以使用指针访问结构成员、通过指针传递结构等。

自引用结构
- 自引用结构是指结构中包含指向自身结构的指针。
- 可以使用自引用结构来实现复杂的数据结构，如二叉树、链表等。

表查找
- 表查找是指按关键字查找表中数据项的过程，通过表来提高查找效率。
- 可以使用结构和指针来实现表的设计和查找功能。

类型定义
- 使用typedef关键字可以定义自己的类型名称，而不必重复书写繁琐的类型声明。
- typedef的作用除了提高程序的可读性和简洁性，还可以让程序更易于移植和修改。

联合
- 联合是一种特殊的结构，所有成员的相对偏移量为0，不同类型的成员共享同一个内存块。
- 联合的可以保存不同类型的数据，在一些特殊场景下可以提高程序的灵活性和效率。

位字段
- 位字段是指使用二进制位来表示特定含义的数据类型。
- 位字段可以提高存储空间的利用率，但也可能会影响程序的可读性和可移植性。

综上所述，结构在C语言中是一个非常重要的概念，在实际应用中也经常被使用。掌握了这些知识点，对于程序的设计和实现都有很大的帮助。


第五章习题及答案：

1. 假设有如下声明：
   ```c
   char *a[];
   ```
   表达式`sizeof(a)`的值是什么？

   答案：该表达式的值为指针大小的整数倍，等于指针的长度。

2. 假设有如下代码：
   ```c
   char *p="12345";
   ```
   下面的代码有何不同？
   ```c
   char a[]="12345";
   ```
   答案：第一个定义的是指针，第二个定义的是字符数组，两种方式存储的方式不同。

3. 下面哪些表达式是合法的？

   ```c
   a. ptr->name;
   b. ptr.name;
   c. (*ptr).name;
   d. ptr[0].name;
   e. ptr->name[0];
   ```

   答案：a、c、d、e是合法的，b不合法。

4. 以下函数能否正确编译？
   ```c
   int strlen(char *s) {
       int n;
       for (n = 0; *s != '\0'; s++) {
           n++;
       }
       return n;
   }
   ```
   答案：可以正确编译。

5. 以下函数能否正确编译？
   ```c
   void strcpy(char *s, char *t) {
       while (*s++ = *t++) {
           ;
       }
   }
   ```
   答案：可以正确编译。

第六章习题及答案：

1. 对于以下结构定义：
   ```c
   struct point {
       int x;
       int y;
   };
   ```
   如果定义了以下结构变量：
   ```c
   struct point pt = {320, 200};
   ```
   然后执行下面的操作：
   ```c
   struct point *pp = &pt;
   ```
   如何访问变量`pt`的各个成员？如何访问指针`pp`的各个成员？

   答案：可以使用`.`和`->`操作符，如`pt.x`、`pp->x`。

2. 对于以下代码：
   ```c
   struct {
       int a;
       char b[20];
       float c;
   } s;
   ```
   求`s`的长度，以及各成员的偏移量。

   答案：`s`的长度为24字节，`a`的偏移量为0，`b`的偏移量为4，`c`的偏移量为24。

3. 对于以下代码：
   ```c
   struct {
       int a;
       struct {
           char *s;
           int idx;
       } b;
       float c;
   } s;
   ```
   求`s`的长度，以及各成员的偏移量。

   答案：`s`的长度为20字节，`a`的偏移量为0，`b`的偏移量为4，`s`的偏移量为0，`idx`的偏移量为4，`c`的偏移量为12。

4. 下面哪些表达式是合法的？
   ```c
   a. &a[0];
   b. &a;
   c. &a[0][0];
   d. a[1][2];
   e. &a[1][2];
   ```
   ```c
   char a[10][20];
   ```
   答案：a和e是合法的，b、c、d不合法。

5. 对于以下代码：
   ```c
   char *month_name(int n) {
       static char *name[] = {
           "Illegal month",
           "January", "February", "March",
           "April","May","June",
           "July","August","September",
           "October","November","December"
       };
       return (n < 1 || n > 12) ? name[0] : name[n];
   }
   ```
   程序返回的是静态字符串的指针，因此程序可能存在错误。修改程序，使其可以通过指针函数进行正确的返回。

   答案：可以将静态字符串改为静态数组，然后通过数组变量来返回值。例如：
   ```c
   char month_name[12][20] = {
       "Illegal month",
       "January", "February", "March",
       "April","May","June",
       "July","August","September",
       "October","November","December"
   };

   char *get_month_name(int n) {
       return (n < 1 || n > 12) ? month_name[0] : month_name[n];
   }
   ```